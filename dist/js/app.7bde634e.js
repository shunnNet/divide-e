(function(t){function e(e){for(var i,s,u=e[0],o=e[1],c=e[2],l=0,f=[];l<u.length;l++)s=u[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&f.push(a[s][0]),a[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i]);p&&p(e);while(f.length)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,s=1;s<n.length;s++){var o=n[s];0!==a[o]&&(i=!1)}i&&(r.splice(e--,1),t=u(u.s=n[0]))}return t}var i={},a={app:0},r=[];function s(t){return u.p+"js/"+({about:"about"}[t]||t)+"."+{about:"396a2247"}[t]+".js"}function u(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(t){var e=[],n=a[t];if(0!==n)if(n)e.push(n[2]);else{var i=new Promise((function(e,i){n=a[t]=[e,i]}));e.push(n[2]=i);var r,o=document.createElement("script");o.charset="utf-8",o.timeout=120,u.nc&&o.setAttribute("nonce",u.nc),o.src=s(t);var c=new Error;r=function(e){o.onerror=o.onload=null,clearTimeout(l);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[t]=void 0}};var l=setTimeout((function(){r({type:"timeout",target:o})}),12e4);o.onerror=o.onload=r,document.head.appendChild(o)}return Promise.all(e)},u.m=t,u.c=i,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)u.d(n,i,function(e){return t[e]}.bind(null,i));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/divide-e/dist/",u.oe=function(t){throw console.error(t),t};var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var p=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"012e":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"btn--base",attrs:{type:"button"},on:{click:t.downloadSetting}},[t._v("下載設定")])},a=[],r=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),{props:{value:{type:Object,required:!0}},methods:{downloadSetting:function(){var t=new Blob([JSON.stringify(this.value,null,2)],{type:"application/json"}),e=URL.createObjectURL(t);function n(t,e){var n=document.createElement("a");n.download=e,n.href=t,n.click()}n(e,"settings.json")}}}),s=r,u=n("2877"),o=Object(u["a"])(s,i,a,!1,null,null,null);e["a"]=o.exports},"336e":function(t,e,n){},"34d4":function(t,e,n){},"48cb":function(t,e,n){"use strict";n("a382")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},r=[],s=n("2877"),u={},o=Object(s["a"])(u,a,r,!1,null,null,null),c=o.exports,l=(n("d3b7"),n("8c4f")),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"divider box-md"},[n("h1",{staticClass:"h1"},[t._v("Excel 切割")]),t.haveOutputed?t._e():n("div",{staticClass:"progress__bar"}),n("ProgressBar",{ref:"progress",scopedSlots:t._u([{key:"default",fn:function(e){var i=e.progress;return[i?n("p",{staticClass:"progress-report"},[t._v(" "+t._s(1!==i?"正在輸出檔案..."+Math.ceil(100*i)+"%":"輸出完成！")+" ")]):t._e()]}}])}),n("div",{staticClass:"fixBox"},[n("DownloadJson",{staticClass:"download-json",attrs:{value:t.outputs}}),n("LoadJson",{staticClass:"load-json",on:{load:t.onImportSetting}})],1),n("FileLoader",{ref:"fileLoader",staticClass:"mb-10",attrs:{"need-process":t.needProcess},on:{"update:needProcess":function(e){t.needProcess=e},"update:need-process":function(e){t.needProcess=e}}}),n("OutputController",{attrs:{outputs:t.outputs,outputing:t.outputing},on:{"update:outputs":function(e){t.outputs=e},output:function(e){return t.process(e)}}}),n("transition",{attrs:{name:"overlay",appear:""}},[t.overlay?n("div",{staticClass:"overlay"}):t._e()]),n("transition",{attrs:{name:"modal",appear:""}},[t.showFilterBoard?n("FilterBoard",{staticClass:"modal index-filterBoard"}):t._e()],1),n("transition",{attrs:{name:"modal",appear:""}},[t.confirm?n("ConfirmModal",{staticClass:"modal"}):t._e(),t.alert?n("AlertModal",{staticClass:"modal"}):t._e()],1)],1)},f=[],d=n("fecc"),m=d["a"],h=(n("ca9c"),Object(s["a"])(m,p,f,!1,null,null,null)),v=h.exports;i["a"].use(l["a"]);var g=[{path:"/",name:"Index",component:v},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],b=new l["a"]({routes:g}),_=b;n("a24a"),n("c243");i["a"].config.productionTip=!1,i["a"].directive("validity",{bind:function(t,e){var n=e.modifiers.lazy?"change":"input";t.addEventListener(n,(function(){this.checkValidity()&&!t.validity.customError||t.reportValidity()}))}}),new i["a"]({router:_,render:function(t){return t(c)}}).$mount("#app")},"5a58":function(t,e,n){"use strict";n("d903")},"6c85":function(t,e,n){"use strict";(function(t){n("4de4"),n("b0c0"),n("96cf");var i=n("1da1"),a=n("e8ae"),r=n.n(a),s=new Worker(t,void 0);e["a"]={props:["need-process"],data:function(){return{file:null,workbook:new r.a.Workbook,worksheets:[],outputSheetName:""}},watch:{worksheets:{deep:!0,handler:function(t,e){this.updateNeedProcess()}},outputSheetName:function(){this.updateNeedProcess()}},mounted:function(){var t=this;s.onmessage=function(e){t.worksheets=e.data}},methods:{updateNeedProcess:function(){var t=this;this.$emit("update:needProcess",this.worksheets.filter((function(e){return e.name===t.outputSheetName})))},loadWorkbook:function(t){this.worksheets=[],t.target.files.length>0&&(this.file=t.target.files[0],t.target.files[0].arrayBuffer().then(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.postMessage({type:"field",blob:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))}}}}).call(this,n("9cc2"))},"6e10":function(t,e,n){"use strict";n("d23c")},"711e":function(t,e,n){"use strict";var i,a,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{staticClass:"board",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("header",{staticClass:"board__header"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.setting.filename,expression:"setting.filename"}],ref:"fileInput",staticClass:"board__header__filename editableInput",attrs:{type:"text",placeholder:"輸入檔案名稱",required:""},domProps:{value:t.setting.filename},on:{input:function(e){e.target.composing||t.$set(t.setting,"filename",e.target.value)}}}),n("div",[n("button",{staticClass:"btn--contrast mr-5",attrs:{type:"button"},on:{click:function(e){return t.addGroup()}}},[t._v(" 新增群組 ")])]),n("div",{staticClass:"board__header__insert-group"},[n("button",{staticClass:"btn--main",attrs:{type:"button"},on:{click:function(e){return t.insertFileFormat("[昨天日期]")}}},[t._v(" 昨天日期 ")]),n("button",{staticClass:"btn--main",attrs:{type:"button"},on:{click:function(e){return t.insertFileFormat("[當天日期]")}}},[t._v(" 當天日期 ")]),n("button",{staticClass:"btn--main",attrs:{type:"button"},on:{click:function(e){return t.insertFileFormat("[明天日期]")}}},[t._v(" 明天日期 ")]),n("button",{staticClass:"btn--main",attrs:{type:"button"},on:{click:function(e){return t.insertFileFormat("[後天日期]")}}},[t._v(" 後天日期 ")])])]),n("div",{staticClass:"board__body"},[n("FieldSeletor",{model:{value:t.setting.fields,callback:function(e){t.$set(t.setting,"fields",e)},expression:"setting.fields"}}),t._l(t.setting.filterGroup,(function(e,i){return n("section",{key:i,staticClass:"group"},[n("button",{staticClass:"btn--lightSub mb-10 mr-10",attrs:{type:"button",disabled:!(t.setting.filterGroup.length>1)},on:{click:function(e){return t.removeGroup(i)}}},[t._v(" 移除群組 ")]),n("button",{staticClass:"btn--main",attrs:{type:"button"},on:{click:function(n){return t.addFilter(e)}}},[t._v(" 新增篩選器 ")]),t._l(e,(function(i,a){return n("div",{key:a,staticClass:"filter"},[n("input",{staticClass:"mr-10",attrs:{type:"text",placeholder:"請輸入表頭名稱",required:""},domProps:{value:i.field},on:{input:function(t){i.field=t.target.value}}}),n("input-filter",{staticClass:"d-flex mr-10",attrs:{func:i.funcName,value:i.value},on:{"update:func":function(e){return t.$set(i,"funcName",e)},"update:value":function(e){return t.$set(i,"value",e)}}}),n("button",{staticClass:"btn--lightSub",attrs:{type:"button",disabled:!(e.length>1)},on:{click:function(n){return t.removeFilter(e,a)}}},[t._v(" 移除 ")])],1)}))],2)}))],2),n("footer",{staticClass:"board__footer"},[n("button",{staticClass:"btn--lightSub mr-5",attrs:{type:"button"},on:{click:function(e){return t.close()}}},[t._v(" 取消 ")]),n("button",{staticClass:"btn--main",attrs:{type:"submit"}},[t._v("提交")])])])},s=[],u=(n("99af"),n("a434"),n("caad"),n("d81d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["checkbox"===t.type?n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model",value:t.min,expression:"min"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.min)?t._i(t.min,null)>-1:t.min},on:{input:function(e){return t.$emit("input",[t.min,t.max])},change:function(e){var n=t.min,i=e.target,a=!!i.checked;if(Array.isArray(n)){var r=null,s=t._i(n,r);i.checked?s<0&&(t.min=n.concat([r])):s>-1&&(t.min=n.slice(0,s).concat(n.slice(s+1)))}else t.min=a}}},"input",Object.assign({},t.inputAttrs,t.input1Attrs),!1),Object.assign({},t.inputEvent,t.input1Event))):"radio"===t.type?n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model",value:t.min,expression:"min"}],attrs:{type:"radio"},domProps:{checked:t._q(t.min,null)},on:{input:function(e){return t.$emit("input",[t.min,t.max])},change:function(e){t.min=null}}},"input",Object.assign({},t.inputAttrs,t.input1Attrs),!1),Object.assign({},t.inputEvent,t.input1Event))):n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model",value:t.min,expression:"min"}],attrs:{type:t.type},domProps:{value:t.min},on:{input:[function(e){e.target.composing||(t.min=e.target.value)},function(e){return t.$emit("input",[t.min,t.max])}]}},"input",Object.assign({},t.inputAttrs,t.input1Attrs),!1),Object.assign({},t.inputEvent,t.input1Event))),t._v(" ~ "),"checkbox"===t.type?n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model",value:t.max,expression:"max"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.max)?t._i(t.max,null)>-1:t.max},on:{input:function(e){return t.$emit("input",[t.min,t.max])},change:function(e){var n=t.max,i=e.target,a=!!i.checked;if(Array.isArray(n)){var r=null,s=t._i(n,r);i.checked?s<0&&(t.max=n.concat([r])):s>-1&&(t.max=n.slice(0,s).concat(n.slice(s+1)))}else t.max=a}}},"input",Object.assign({},t.inputAttrs,t.input2Attrs),!1),Object.assign({},t.inputEvent,t.input2Event))):"radio"===t.type?n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model",value:t.max,expression:"max"}],attrs:{type:"radio"},domProps:{checked:t._q(t.max,null)},on:{input:function(e){return t.$emit("input",[t.min,t.max])},change:function(e){t.max=null}}},"input",Object.assign({},t.inputAttrs,t.input2Attrs),!1),Object.assign({},t.inputEvent,t.input2Event))):n("input",t._g(t._b({directives:[{name:"model",rawName:"v-model",value:t.max,expression:"max"}],attrs:{type:t.type},domProps:{value:t.max},on:{input:[function(e){e.target.composing||(t.max=e.target.value)},function(e){return t.$emit("input",[t.min,t.max])}]}},"input",Object.assign({},t.inputAttrs,t.input2Attrs),!1),Object.assign({},t.inputEvent,t.input2Event)))])}),o=[],c={inheritAttrs:!1,props:{type:{type:String,default:function(){return"text"}},value:{type:Array,default:function(){return["",""]}},inputAttrs:{type:Object,default:function(){return{}}},inputEvent:{type:Object,default:function(){return{}}},input1Attrs:{type:Object,default:function(){return{}}},input1Event:{type:Object,default:function(){return{}}},input2Attrs:{type:Object,default:function(){return{}}},input2Event:{type:Object,default:function(){return{}}}},data:function(){return{min:this.value[0],max:this.value[1]}}},l=c,p=n("2877"),f=Object(p["a"])(l,u,o,!1,null,null,null),d=f.exports,m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{attrs:{type:"text"},domProps:{value:t.inputValue},on:{input:function(e){return t.process(e)}}})},h=[],v={props:{value:{default:function(){return new Date}},lazy:{type:Boolean,default:function(){return!0}}},data:function(){return{inputValue:"",realValue:new Date}},computed:{event:function(){return this.lazy?"change":"input"}},created:function(){this.isValidDate(this.value)&&(this.realValue=new Date(this.value),this.inputValue=this.toViewFormat(this.realValue))},methods:{toViewFormat:function(t){return t.toLocaleString("zh-TW",{hour12:!1,day:"2-digit",hour:"numeric",minute:"numeric",second:"numeric",month:"2-digit",year:"numeric"})},setTimeIfValidDate:function(t,e){var n=Date.parse(e),i=!isNaN(n);return i&&t.setTime(e),i},isValidDate:function(t){return!isNaN(Date.parse(t))},process:function(t){this.isValidDate(t.target.value)?(this.realValue.setTime(Date.parse(t.target.value)),t.target.setCustomValidity(""),this.$emit(this.event,this.realValue)):t.target.setCustomValidity("請輸入日期，格式: YYYY/MM/DD hh:mm:ss")}}},g=v,b=Object(p["a"])(g,m,h,!1,null,null,null),_=b.exports,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{attrs:{type:"text"},domProps:{value:t.inputValue},on:{input:function(e){return t.process(e)}}})},w=[],x={props:{value:{default:function(){return new Date}},lazy:{type:Boolean,default:function(){return!0}}},data:function(){return{inputValue:"",realValue:new Date}},computed:{event:function(){return this.lazy?"change":"input"}},created:function(){this.isValidDate(this.value)&&(this.realValue=new Date(this.value),this.inputValue=this.toViewFormat(this.realValue))},methods:{toViewFormat:function(t){return t.toLocaleString("zh-TW",{hour12:!1,day:"2-digit",month:"2-digit",year:"numeric"})},setTimeIfValidDate:function(t,e){var n=Date.parse(e),i=!isNaN(n);return i&&t.setTime(e),i},isValidDate:function(t){return!isNaN(Date.parse(t))},process:function(t){this.isValidDate(t.target.value)?(this.realValue.setTime(Date.parse(t.target.value)),this.realValue.setHours(0,0,0),t.target.setCustomValidity(""),this.$emit(this.event,this.realValue)):t.target.setCustomValidity("請輸入日期，格式: YYYY/MM/DD")}}},k=x,O=Object(p["a"])(k,y,w,!1,null,null,null),j=O.exports,C={name:"inputFilter",props:{tag:{type:String,default:function(){return"div"}},func:{type:String,default:function(){return"includes"}},value:null},components:{inputRange:d,inputDatetime:_,inputDate:j},data:function(){return{filterActions:[{value:"includes",label:"包含"},{value:"startsWith",label:"開頭"},{value:"endsWith",label:"結尾"},{value:"moreThan",label:"多於"},{value:"moreThanOrEqual",label:"多於(含)"},{value:"lessThan",label:"少於"},{value:"lessThanOrEqual",label:"少於(含)"},{value:"laterThan",label:"晚於(日期)"},{value:"earlierThan",label:"早於(日期)"},{value:"isCertainDay",label:"特定日期"}]}},computed:{type:{get:function(){return this.func},set:function(t){this.$emit("update:func",t)}},v:{get:function(){return this.value},set:function(t){this.$emit("update:value",t)}}},render:function(t){var e,n=this;switch(this.type){case"includes":case"startsWith":case"endsWith":e=t("input",{directives:[{name:"validity"}],attrs:{type:"text",value:this.v,placeholder:"請輸入文字",required:!0},on:{input:function(t){return n.v=t.target.value}},key:"".concat(this._uid,"-").concat(this.type)});break;case"moreThan":case"moreThanOrEqual":case"lessThanOrEqual":case"lessThan":e=t("input",{directives:[{name:"validity"}],attrs:{type:"number",value:this.v,placeholder:"請輸入數字",required:!0},on:{input:function(t){return n.v=parseFloat(t.target.value,10)}},key:"".concat(this._uid,"-").concat(this.type)});break;case"laterThan":case"earlierThan":case"isCertainDay":e=t("inputDate",{directives:[{name:"validity",modifiers:{lazy:!0}}],attrs:{value:this.v,required:!0},on:{change:function(t){return n.v=t}},key:"".concat(this._uid,"-").concat(this.type)});break;case"laterThanDateTime":case"earlierThanDateTime":case"isCertainDateTime":e=t("inputDatetime",{directives:[{name:"validity",modifiers:{lazy:!0}}],attrs:{value:this.v,required:!0},on:{change:function(t){return n.v=t}},key:"".concat(this._uid,"-").concat(this.type)});break}var i=this.filterActions.map((function(e){return t("option",{attrs:{value:e.value}},e.label)})),a=t("select",{class:{"mr-5":!0},domProps:{value:this.type},on:{change:function(t){var e=["inDateRange","inNumRange"].includes(t.target.value)?["",""]:"";n.$set(n,"v",e),n.type=t.target.value}}},i);return t(this.tag,[a,e])}},S=C,F=Object(p["a"])(S,i,a,!1,null,null,null),D=F.exports,$=n("c36a"),A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Multiselect",{attrs:{options:t.innerField,taggable:!0,"track-by":"value",multiple:!0,placeholder:"填上要輸出的欄位名稱(若沒有就會輸出全部)"},on:{tag:t.addTag,remove:t.handleRemove},model:{value:t.innerField,callback:function(e){t.innerField=e},expression:"innerField"}})},E=[],N=(n("c740"),n("2909")),P=n("8e5f"),T=n.n(P),V={components:{Multiselect:T.a},model:{prop:"field",event:"change"},props:{field:{type:Array,default:function(){return[]}}},data:function(){return{innerField:Object(N["a"])(this.field)}},watch:{field:function(){this.innerField=Object(N["a"])(this.field)}},methods:{handleRemove:function(t){var e=this.innerField.findIndex((function(e){return e===t}));this.innerField.splice(e,1),this.$emit("change",this.innerField)},addTag:function(t){this.innerField.push(t),this.$emit("change",this.innerField)}}},B=V,q=(n("60bc"),Object(p["a"])(B,A,E,!1,null,null,null)),M=q.exports,L={components:{inputFilter:D,FieldSeletor:M},data:function(){return{setting:{},showInsertBtn:!1,options:[{name:"Vue.js",code:"vu"},{name:"Javascript",code:"js"},{name:"Open Source",code:"os"}]}},computed:{fields:function(){return $["d"].state.fields}},created:function(){this.$watch((function(){return $["c"].state.passDown}),(function(t,e){this.setFileSetting(t)})),this.setFileSetting($["c"].state.passDown)},methods:{setFileSetting:function(t){return this.setting=JSON.parse(JSON.stringify(t)),this},close:function(){$["c"].show(!1)},submit:function(){$["c"].passBack(this.setting).show(!1)},addGroup:function(){this.setting.filterGroup.push([{field:this.fields[0],funcName:"includes",value:""}])},removeGroup:function(t){console.log("removeGroup"),this.setting.filterGroup.splice(t,1)},addFilter:function(t){t.push({field:this.fields[0],funcName:"includes",value:""})},removeFilter:function(t,e){console.log("removeFilter"),t.splice(e,1)},insertFileFormat:function(t){if(t){var e=this.$refs.fileInput,n=e.value.substring(0,e.selectionStart),i=e.value.substring(e.selectionEnd);this.setting.filename="".concat(n).concat(t).concat(i)}}}},J=L,I=(n("ca3f"),Object(p["a"])(J,r,s,!1,null,null,null));e["a"]=I.exports},"7a0f":function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",[t._t("default",[n("p",{staticClass:"btn btn--base"},[t._v("載入設定")])]),n("input",{attrs:{hidden:"hidden",type:"file"},on:{change:function(e){return t.importJSON(e)}}})],2)},a=[],r={methods:{importJSON:function(t){var e=this,n=t.target.files[0];if(n){var i=new FileReader;i.onload=function(t){e.$emit("load",t.currentTarget.result)},i.readAsText(n)}}}},s=r,u=n("2877"),o=Object(u["a"])(s,i,a,!1,null,null,null);e["a"]=o.exports},"8a14":function(t,e,n){},"9cc2":function(t,e,n){t.exports=n.p+"js/1.9d4fcbf5.worker.js"},a24a:function(t,e,n){},a29d:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",[n("button",{staticClass:"btn--base mr-050",on:{click:function(e){return t.addOutput()}}},[t._v("新增設定")]),n("button",{staticClass:"btn--main mr-050",attrs:{disabled:t.outputing},on:{click:function(e){return t.processAll()}}},[t._v(" 全部輸出 ")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchSetting,expression:"searchSetting"}],attrs:{type:"text",placeholder:"篩選要輸出的檔案設定"},domProps:{value:t.searchSetting},on:{input:function(e){e.target.composing||(t.searchSetting=e.target.value)}}})]),n("transition-group",{staticClass:"outputs",attrs:{tag:"ul"}},t._l(t.outputDisplaying,(function(e,i){return n("li",{key:e.id,staticClass:"outputs__line pd-050 d-flex f-cross-center f-main-between"},[n("a",{staticClass:"outputs__line__name flex-1",attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.openOutputSetting(e)}}},[t._v(" "+t._s(e.filename)+" ")]),n("div",[n("button",{staticClass:"btn--main mr-050",attrs:{disabled:t.outputing},on:{click:function(n){return t.processSingle(e.id)}}},[t._v(" 輸出 ")]),n("button",{staticClass:"btn--lightSub",on:{click:function(n){return t.deleteConfirm(e)}}},[t._v(" 刪除 ")])])])})),0)],1)},a=[],r=(n("4de4"),n("caad"),n("d81d"),n("07ac"),n("2532"),n("c36a")),s={props:["outputs","outputing"],computed:{outputDisplaying:function(){var t=this;return this.searchSetting?Object.values(this.outputs).filter((function(e){return e.filename.includes(t.searchSetting)})):Object.values(this.outputs)}},data:function(){return{outputSetting:this.outputs,searchSetting:""}},created:function(){this.$watch((function(){return r["c"].state.passBack}),(function(t,e){null!==t&&this.setOutputSetting(t)})),this.outputSetting=this.outputs},methods:{deleteOutput:function(t){this.searchSetting="",this.$delete(this.outputSetting,t),localStorage.setItem("setting",JSON.stringify(this.outputSetting)),this.$emit("update:outputs",this.outputSetting)},addOutput:function(){this.searchSetting="";var t=String(Date.now());return this.openOutputSetting({filename:"Output Filename",id:t,fields:[],filterGroup:[[{field:"",funcName:"includes",value:""}]]}),this},setOutputSetting:function(t){return this.$set(this.outputSetting,t.id,t),localStorage.setItem("setting",JSON.stringify(this.outputSetting)),this.$emit("update:outputs",this.outputSetting),this},openOutputSetting:function(t){r["c"].passDown(t).show(!0)},processSingle:function(t){this.$emit("output",[t])},processAll:function(){var t=this;r["b"].show("輸出全部","確定要輸出畫面上的所有檔案嗎? (這可能會花一點時間)").then((function(){return t.$emit("output",t.outputDisplaying.map((function(t){return t.id})))})).catch((function(){}))},deleteConfirm:function(t){var e=this;r["b"].show("刪除設定","您確定要刪除 ".concat(t.filename,"?")).then((function(){return e.deleteOutput(t.id)})).catch((function(){}))}}},u=s,o=(n("5a58"),n("2877")),c=Object(o["a"])(u,i,a,!1,null,null,null);e["a"]=c.exports},a382:function(t,e,n){},b359:function(t,e,n){t.exports=n.p+"js/0.50707f17.worker.js"},c0b4:function(t,e,n){"use strict";n("c6d7")},c243:function(t,e,n){},c36a:function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return o}));n("d3b7");var i=n("2b0e"),a={state:i["a"].observable({show:!1})},r={state:i["a"].observable({show:!1,resolve:null,reject:null,title:"Confirm",msg:"Please confirm"}),show:function(t,e){var n=this;return new Promise((function(i,r){a.state.show=!0,n.state.show=!0,n.state.resolve=i,n.state.reject=r,n.state.title=t||n.title,n.state.msg=e||n.msg}))},close:function(){a.state.show=!1,this.state.show=!1,this.state.resolve=null,this.state.reject=null,this.state.title="",this.state.msg=""}},s={state:i["a"].observable({show:!1,resolve:null,reject:null,title:"Confirm",msg:"Please confirm"}),show:function(t,e){var n=this;return new Promise((function(i,r){a.state.show=!0,n.state.show=!0,n.state.resolve=i,n.state.reject=r,n.state.title=t||n.title,n.state.msg=e||n.msg}))},close:function(){a.state.show=!1,this.state.show=!1,this.state.resolve=null,this.state.reject=null,this.state.title="",this.state.msg=""}},u={state:i["a"].observable({fields:[]})},o={state:i["a"].observable({showFilterBoard:!1,passDown:{filename:"",fields:[],id:"",filterGroup:[]},passBack:{filename:"",fields:[],id:"",filterGroup:[]}}),passDown:function(t){return i["a"].set(this.state,"passDown",t),i["a"].set(this.state,"passBack",null),this},passBack:function(t){return i["a"].set(this.state,"passDown",null),i["a"].set(this.state,"passBack",t),this},show:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.state.showFilterBoard=t,a.state.show=t,this}}},c6d7:function(t,e,n){},ca3f:function(t,e,n){"use strict";n("336e")},ca9c:function(t,e,n){"use strict";n("34d4")},d1ca:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"progress"},[n("div",{staticClass:"progress__bar",style:{transform:"scaleX("+t.progress+")"}}),t._t("default",null,{progress:t.progress})],2)},a=[],r={data:function(){return{now:0,end:100,duration:3e3,rAf:null,running:!1}},computed:{progress:function(){return this.now/this.end}},methods:{reset:function(){return this.now=0,this.end=100,this},beizer:function(t){return t*(2-t)},to:function(t){var e=this,n=t.to,i=t.duration;if(!this.running){this.running=!0;var a=0,r=n>100?100:n<0?0:n,s=r-this.now,u=this.now,o=function t(n){a=0===a?n:a;var o=n-a,c=function(t,n){var a=n/i;return a=a>1?1:a,s*e.beizer(a)},l=function(){return s>0?f<r:s<0?f>r:void 0},p=c(r,o),f=u+p;e.$nextTick((function(){var n=l();n?(e.now=f,e.rAf=requestAnimationFrame(t)):(e.now=r,e.running=!1)}))};return this.rAf=requestAnimationFrame(o),this}},pause:function(){return cancelAnimationFrame(this.rAf),this.running=!1,this}}},s=r,u=(n("e74c"),n("2877")),o=Object(u["a"])(s,i,a,!1,null,null,null);e["a"]=o.exports},d23c:function(t,e,n){},d822:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fileLoader"},[n("input",{ref:"file",staticClass:"fileLoader__upload",attrs:{type:"file"},on:{change:function(e){return t.loadWorkbook(e)}}}),n("div",t._l(t.worksheets,(function(e){return n("label",{key:e.id,staticClass:"fileLoader__check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.outputSheetName,expression:"outputSheetName"}],attrs:{type:"radio"},domProps:{value:e.name,checked:t._q(t.outputSheetName,e.name)},on:{change:function(n){t.outputSheetName=e.name}}}),t._v(" "+t._s(e.name)+" ")])})),0)])},a=[],r=n("6c85"),s=r["a"],u=(n("c0b4"),n("2877")),o=Object(u["a"])(s,i,a,!1,null,null,null);e["a"]=o.exports},d903:function(t,e,n){},e74c:function(t,e,n){"use strict";n("8a14")},f6c6:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"confirm"},[n("h4",{staticClass:"confirm__title"},[t._v(t._s(t.title))]),n("p",{staticClass:"confirm__msg"},[t._v(t._s(t.msg))]),n("div",{staticClass:"confirm__btns"},[n("button",{staticClass:"btn--lightSub",attrs:{type:"button"},on:{click:function(e){return t.cancel()}}},[t._v(" 取消 ")]),n("button",{staticClass:"confirm__btns__main btn--main",attrs:{type:"button"},on:{click:function(e){return t.confirm()}}},[t._v(" 確定 ")])])])},a=[],r=n("c36a"),s={data:function(){return{}},computed:{msg:function(){return r["b"].state.msg},title:function(){return r["b"].state.title},resolve:function(){return r["b"].state.resolve},reject:function(){return r["b"].state.reject}},methods:{confirm:function(){this.resolve(),r["b"].close()},cancel:function(){this.reject(),r["b"].close()}}},u=s,o=(n("48cb"),n("2877")),c=Object(o["a"])(u,i,a,!1,null,null,null);e["a"]=c.exports},f717:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"alert"},[n("h4",{staticClass:"alert__title"},[t._v(t._s(t.title))]),n("p",{staticClass:"alert__msg"},[t._v(t._s(t.msg))]),n("div",{staticClass:"alert__btns"},[n("button",{staticClass:"alert__btns__main btn--main",attrs:{type:"button"},on:{click:function(e){return t.confirm()}}},[t._v(" 確定 ")])])])},a=[],r=n("c36a"),s={data:function(){return{}},computed:{msg:function(){return r["a"].state.msg},title:function(){return r["a"].state.title},resolve:function(){return r["a"].state.resolve},reject:function(){return r["a"].state.reject}},methods:{confirm:function(){this.resolve(),r["a"].close()},cancel:function(){this.reject(),r["a"].close()}}},u=s,o=(n("6e10"),n("2877")),c=Object(o["a"])(u,i,a,!1,null,null,null);e["a"]=c.exports},fecc:function(t,e,n){"use strict";(function(t){n("b0c0"),n("96cf");var i=n("1da1"),a=n("21a6"),r=n("c36a"),s=n("d822"),u=n("711e"),o=n("a29d"),c=n("f6c6"),l=n("f717"),p=n("012e"),f=n("7a0f"),d=n("2b0e"),m=n("d1ca"),h=new Worker(t,void 0),v=d["a"].observable({outputing:!1});e["a"]={name:"Home",components:{FileLoader:s["a"],FilterBoard:u["a"],OutputController:o["a"],ConfirmModal:c["a"],AlertModal:l["a"],ProgressBar:m["a"],DownloadJson:p["a"],LoadJson:f["a"]},data:function(){return{needProcess:[],outputs:{},amount:70,haveOutputed:!1}},created:function(){var t=localStorage.getItem("setting");t&&(this.outputs=JSON.parse(t))},mounted:function(){var t=this;h.onmessage=function(e){switch(e.data.type){case"complete":a["saveAs"](e.data.blob,"".concat(e.data.name,".xlsx")),v.outputing=!1,t.progressTo(100);break;case"progress":t.progressTo(e.data.progress);default:break}}},computed:{outputing:function(){return v.outputing},overlay:function(){return r["e"].state.show},showFilterBoard:function(){return r["c"].state.showFilterBoard},confirm:function(){return r["b"].state.show},alert:function(){return r["a"].state.show}},methods:{onImportSetting:function(t){localStorage.setItem("setting",t),window.location.reload()},progressTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.$refs.progress.pause().to({to:t,duration:e})},process:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.$refs.progress.reset(),!(e.needProcess.length>0&&t.length>0)){n.next=7;break}e.haveOutputed=!0,v.outputing=!0,e.$refs.fileLoader.file.arrayBuffer().then((function(n){var i={type:"output",settings:e.outputs,ids:t,needProcess:e.needProcess,buffer:n};e.progressTo(10),h.postMessage(i)})),n.next=9;break;case 7:return n.next=9,r["a"].show("輸出檔案","請選擇要切割的 「檔案」 及 「工作表」，或至少設定一個輸出設定");case 9:case"end":return n.stop()}}),n)})))()}}}}).call(this,n("b359"))}});
//# sourceMappingURL=app.7bde634e.js.map